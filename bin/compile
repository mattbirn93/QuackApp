#!/usr/bin/env bash
set -e

# Create certs directory if it doesn't exist
mkdir -p certs

# Check if the key and certificate files exist, if not create dummy files
if [ ! -f certs/key.pem ]; then
    echo "Creating dummy key.pem"
    cat <<EOF > certs/key.pem
-----BEGIN PRIVATE KEY-----
YMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC8jbyObSX6oD4c
B+sw2UHHdGRaF3qSedfwa/9F50ReEZoBYWFrdu2X4CFyqbga0lel38RSV2SwxPv8
ZbsFUEq9ASX1uojqSsoBFc/L+2ZSFTDbhr9bjKdjdbLiiKM6IwldY5s8H75w/vtK
kydQm1LliEPFDULr3Q5dF7VFzq5EpGLTnt7IH8T+1UZtDmPJ/fkAXfMdLUAEy5KB
IxosOlCVtWvi4LDoymUWN3mkOx2mhE6KvIuTlQ4MGwovGKcNLlI3A3doCiwB0mZB
2WG+6jkrh3tEXUL8ntkSOn5Sq59/4OO0ZAyQvIMA7IM8wZyEg1laZIPO9HXTBcVc
ZeOc+2tZAgMBAAECggEAFHEFTSeWI3q14RIWtGAJWpdKvd2nwzOEbqM2tJxi9BPS
b23gQudM0NdSqPyvYfEF4YzF2utwlh10+CMLSIMw5xa1x9MmPshG6CE2OvYRXLrB
ZjtQiZtRFl5PO3H2yDm+LSq8TKNgYR2znp0feQSt0waX2kgaxjlb8km8tEm46OX9
znesSJgOF8ybYKRLTJyrW+eC3C9MhuKEnewkL8YnqK2x1XnidRZk05eSAGI+xSPy
ZbK7salGujsmfWBmwDrvgJDqTlS0hJs9xoPxN9ByT/9rd+kNml+tC3X0viAqd//w
lJQOe7wQqK6lhUNkdkY7dvj2uU/tQdg2YtoR9rupEQKBgQDgtQwc/7ch06t2ELjK
BeWoq75KeCSRw8+R+i7D3MGV4pFnN4AeQGnig5AbGqV4FrDPA0h1Io9zUOhDNv3Y
5g8u3THJNUsIXtEMv/CnGq/Y8b9gWE9X+UNeqj3/J+c9KUEkdpW1YoQV6WYf2AY9
tlHjD7XhYBMMA4e3seRajiCJ5QKBgQDWz8rUgmNslkIXqDD+zNoEbb3u6n7x12BC
FnA+Y5CHuNIjLnfQtDyN4xi8wpOfmlJFkW3piF77tVRnd9ahTrsgMrXegcMbqaTF
t5r73cgUwsfxug+FWrjtaX/k85tlQDvrnOehzuYUygLnaggXFG23GqMwBl4GHv7t
hiubsXC0ZQKBgCzS0JzEQbKkt5Iwmbvq2zn/MFFIj/rntXMoFcYKNi+A54JQZuUh
8j02Azv038cJt7FDtWNwRm85V2t4/8ARfDvb8b9yOwprZ4YEj6u1vhgneQZt9z3U
QiUTDpTkT9M6dH0ijpCFG1YHndCCVhRfVwxVKPHRKVt/JMZ23NdXfJQlAoGBAJVL
9E/Ak7OLt0HT7sGYxMohL8nWhwY0x70G9VoXPwNla/9xs2qFajS/Kpk+rvVVf2rE
idyuoD1XKOOEwdJ48suNEyQjkeQvAss8MeZtnTr4qZiS1Wi8xhyTn4UT3uP/QeYe
tkqajwTR5jTKV/cahqqlQ9gEBONCNbIF91cNeySVAoGBAJlDNow2rrk0pbP8Rcam
luVZHG1VMvqXI/7PcLfYQyTbf9nz4qWyHhYao8UBEDLpK3E43yZ456A7mMr7uY9g
N3m+H4do7vzVKSXqQkv7dGQvnaDmIsZferOwwGv1dEmIEbUc2k3rGf0lZzWpJGfY
yaSJyh/Gi3yv3QCeWLIcF6qq
-----END PRIVATE KEY-----
EOF
fi

if [ ! -f certs/cert.pem ]; then
    echo "Creating dummy cert.pem"
    cat <<EOF > certs/cert.pem
-----BEGIN CERTIFICATE-----
MIIEFTCCAv2gAwIBAgIUfrs4QSlK1UFs/XkyBn8Cq99kop4wDQYJKoZIhvcNAQEL
BQAwgZkxCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxpZm9ybmlhMRcwFQYDVQQH
DA5Xb29kbGFuZCBIaWxsczERMA8GA1UECgwIUXVhY2tBcHAxETAPBgNVBAsMCFF1
YWNrQXBwMREwDwYDVQQDDAhRdWFja0FwcDEjMCEGCSqGSIb3DQEJARYUcXVhY2th
cHA5M0BnbWFpbC5jb20wHhcNMjQwNjAyMDMyNzExWhcNMjUwNjAyMDMyNzExWjCB
mTELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlmb3JuaWExFzAVBgNVBAcMDldv
b2RsYW5kIEhpbGxzMREwDwYDVQQKDAhRdWFja0FwcDERMA8GA1UECwwIUXVhY2tB
cHAxETAPBgNVBAMMCFF1YWNrQXBwMSMwIQYJKoZIhvcNAQkBFhRxdWFja2FwcDkz
QGdtYWlsLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALyNvI5t
JfqgPhwH6zDZQcd0ZFoXepJ51/Br/0XnRF4RmgFhYWt27ZfgIXKpuBrSV6XfxFJX
ZLDE+/xluwVQSr0BJfW6iOpKygEVz8v7ZlIVMNuGv1uMp2N1suKIozojCV1jmzwf
vnD++0qTJ1CbUuWIQ8UNQuvdDl0XtUXOrkSkYtOe3sgfxP7VRm0OY8n9+QBd8x0t
QATLkoEjGiw6UJW1a+LgsOjKZRY3eaQ7HaaEToq8i5OVDgwbCi8Ypw0uUjcDd2gK
LAHSZkHZYb7qOSuHe0RdQvye2RI6flKrn3/g47RkDJC8gwDsgzzBnISDWVpkg870
ddMFxVxl45z7a1kCAwEAAaNTMFEwHQYDVR0OBBYEFNKp6jY+MLP+7miegiMCfBFM
sYtIMB8GA1UdIwQYMBaAFNKp6jY+MLP+7miegiMCfBFMsYtIMA8GA1UdEwEB/wQF
MAMBAf8wDQYJKoZIhvcNAQELBQADggEBAEUsL7w2n+VWiW3Mblgufpit5XQfqM7b
NJin2C4dYN1igYC5hlvrNlcfqp6cD63zhHcXSJsvxwAAwzRbLbZv1J1DO2xdc+7s
+fXkMrNqMoGyScFZ6pQEvNaNi09cZuuPIgBm61lQ3Xh6ioHfo0Kvj1JQAsEv+2AJ
sR7amdbrwJt6GkHV75PSa2VXM5HmaGKomfplPLulFdt4qcl5gL0DNyuKpszjypqd
O9NrZy5j6lwgWiVeVRMOkuX10n0dAjnzjDzX/7LRutTy9LNVHs5PUwp2ksWcHybz
YCh44zzLLgp7xuCjUxxNUlb5O22ndFFmNMNdeK1WFp2juyzdXsc/ZD0=
-----END CERTIFICATE-----
EOF
fi
